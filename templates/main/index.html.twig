{% extends 'base.html.twig' %}

{% block title %}{{parent()}} | Accueil{% endblock %}

{% block body %}
    <h3>Bonjour, {{ app.user.prenom }} !</h3>
    <H4>{% set trans_day_hash = {
        "Monday": "Lundi",
        "Tuesday": "Mardi",
        "Wednesday": "Mercredi",
        "Thursday": "Jeudi",
        "Friday": "Vendredi",
        "Saturday": "Samedi",
        "Sunday": "Dimanche"
    }
    %}
    {{ trans_day_hash["now"|date('l')] }}
        {{ date().format('j') }}

    {% set trans_month_hash = {
        "January": "Janvier",
        "February": "Février",
        "March": "Mars",
        "April": "Avril",
        "May": "Mai",
        "June": "Juin",
        "August": "Août",
        "September": "Septembre",
        "October": "Octobre",
        "November": "Novembre",
        "December": "Décembre"
    }
    %}
    {{ trans_month_hash["now"|date('F')] }}
        {{ date().format('Y') }}</H4>

    <div class="tableauAccueil">
<table>
    <thead>
    <tr>
        <th>Nom de la sortie</th>
        <th>Date de la sortie</th>
        <th>Clôture</th>
        <th>Inscrits/places</th>
        <th>Etat</th>
        <th>Inscrit</th>
        <th>Organisateur</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    {% for sortie in sorties %}
        {% if (sortie.etat.id) != 7 %}
        <tr>
            <td><a href="{{ path('sortie_show', {'idSortie': sortie.id}) }}">{{ sortie.nom }}</td>
            <td>{{ sortie.dateHeureDebut | date('d/m/Y H:i')}}</td>
            <td>{{ sortie.dateLimiteInscription | date('d/m/Y') }}</td>
            <td>
                {% for participant in sortie.participants %}
                    {% set count = count + 1 %}
                {% endfor %}
                {{ count }}
                {% set count = 0 %}/ {{ sortie.nbInscriptionsMax }}
            </td>
            <td>{{ sortie.etat.libelle }}</td>
            <td>
                {% if app.user in sortie.participants %}
                    X
                {% endif %}
            </td>
            <td><a href="{{ path('profile_show', {'id': sortie.organisateur.id}) }}">{{ sortie.organisateur.userIdentifier}}</a> </td>
            <td>

{#                {% if sortie.etat.id == 1 %}
                    <a href="{{ path('sortie_update', {'idSortie': sortie.id})}}">Modifier</a>
                    <a href="{{ path('sortie_publish', {'idSortie': sortie.id}) }}">Publier</a>
                {% endif %}#}

{#                {% if sortie.etat.id == 2  %}#}
{#                    <a href="{{ path('sortie_desinscrire', {'id': sortie.id}) }}">Se désister</a>#}
{#                    <a href="{{ path('sortie_inscrire', {'id': sortie.id}) }}">S'inscrire</a>#}


{#                {% endif %}#}

{#                {% if sortie.etat.id == 3  %}#}
{#                    <a href="{{ path('sortie_desinscrire', {'id': sortie.id}) }}">Se désister</a>#}
{#                {% endif %}#}

{#                {% if sortie.etat.id == 4  %}#}

{#                {% endif %}#}

{#                {% if sortie.etat.id == 5  %}#}
{#                {% endif %}#}

{#                {% if sortie.etat.id == 6  %}#}
{#                {% endif %}#}
        {% if app.user == sortie.organisateur %}
            <a href="{{ path('sortie_cancel', {'idSortie': sortie.id})}}">Annuler</a> -
            <a href="{{ path('sortie_update', {'idSortie': sortie.id})}}">Modifier</a> -
            <a href="{{ path('sortie_publish', {'idSortie': sortie.id}) }}">Publier</a>
        {% endif %}
                {% if app.user in sortie.participants %}
                    <a href="{{ path('sortie_desinscrire', {'id': sortie.id}) }}">Se désister - </a>
                    {%  else %}
                        <a href="{{ path('sortie_inscrire', {'id': sortie.id}) }}">S'inscrire - </a>
                {% endif %}
            </td>
        </tr>
        {% endif %}
    {% endfor %}
    </tbody>
</table>
    </div>
    <button id="createSortie">Créer une sortie</button>
    <script>
        document.getElementById('createSortie').addEventListener('click', function() {
            window.location.href = "{{ path('sortie_add')}}"
        })
    </script>
{% endblock %}
